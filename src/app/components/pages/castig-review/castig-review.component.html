<div class="pt-5">
  <br />
  <app-navbar-promodel></app-navbar-promodel>
  <div
    class="container text-center"
    *ngIf="
      casting != null && hayCategorias == true;
      else templateNohayCategorias
    "
  >
    <ngx-spinner
      name="loadCategorias"
      [fullScreen]="true"
      type="ball-scale-multiple"
      size="medium"
    >
      <p class="loading">...</p>
    </ngx-spinner>
    <div class="pt-5">
      <div class="container" style="margin-top: 1%">
        <div class="row">
          <div class="col col-lg-1">
            <i
              class="bi bi-arrow-return-left"
              style="font-size: 2em"
              (click)="volver()"
            ></i>
          </div>
          <div class="col col-lg-11" style="text-align: left">
            <h1>{{ casting.nombre }}</h1>
          </div>
        </div>

        <div class="row">
          <div class="col col-lg-3">
            <label>{{ "buscar.categorias" | translate }}</label>
          </div>
          <div class="col col-lg-3">
            <select
              class="form-select"
              id="categoriaSelect"
              aria-label="Default select example"
              (change)="onChangeCategoria($event.target.value)"
              [(ngModel)]="CategoriaActual"
            >
              <ng-container *ngIf="casting.categorias.length > 0">
                <option
                  *ngFor="let categoria of categorias"
                  [value]="categoria.id"
                >
                  {{ categoria.nombre }}
                </option>
              </ng-container>
            </select>
          </div>
          <div
            [formGroup]="formAgregarModelo"
            class="col col-lg-4 container text-center"
            *ngIf="puedeAgregarModelo && categoriaSeleccionada"
          >
            <div class="row justify-content-md-center">
              <div class="col-lg-4 col-md-12 col-sm-12">
                <label>{{ "buscar.agregarModelo" | translate }}</label>
              </div>
              <div class="col-lg-6 col-md-8 col-sm-8">
                <input
                  type="text"
                  class="form-control"
                  placeholder="Numero Modelo"
                  aria-label="Username"
                  aria-describedby="basic-addon1"
                  formControlName="consecutivo"
                  onKeypress="if (event.keyCode < 45 || event.keyCode > 57) event.returnValue = false;"
                />
              </div>
              <div class="col-lg-2 col-md-2 col-sm-2 p-1">
                <button
                  type="button"
                  [disabled]="formAgregarModelo.invalid"
                  class="btn btn-primary"
                  (click)="agregarModelo()"
                >
                  +
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="personasDesplegables.length > 0">
      <div *ngIf="dVertical == true && tBusqueda == false; else modoHorizontal">
        <div class="row">
          <div
            class="col-lg-4 col-md-6 col-sm-12 pt-2"
            *ngFor="let modelo of personasDesplegables"
          >
            <app-persona-card
              [direccionVertical]="true"
              [tipoBusqueda]="false"
              [persona]="modelo"
              [permisos]="permisosCast"
            ></app-persona-card>
          </div>
        </div>
      </div>
      <ng-template #modoHorizontal>
        <div class="row">
          <div class="d-block">
            <div
              class="col-lg-4 col-md-6 col-sm-12 pt-5"
              *ngFor="let modelo of personasDesplegables"
            >
              <div class="row">
                <div class="col-lg-1" if>
                  <button
                    type="button"
                    class="btn btn-danger"
                    (click)="confirmar(modelo.id)"
                  >
                    X
                  </button>
                </div>
                <div class="col-lg-12">
                  <app-persona-card
                    [direccionVertical]="false"
                    [tipoBusqueda]="false"
                    [modoRevisor]="true"
                    [persona]="modelo"
                    [mostrarGenerales]="permisosCast.verDatosGenerales"
                    [mostrarGaleria]="permisosCast.verGaleriaPersonal"
                    [mostrarHabilidades]="permisosCast.verHabilidades"
                    [verTelefono]="permisosCast.verTelefono"
                    [verEmail]="permisosCast.verEmail"
                    [verDireccion]="permisosCast.verDireccion"
                    [verComentarios]="permisosCast.verComentarios"
                    [verRedesSociales]="permisosCast.verRedesSociales"
                    (personaCargada)="personaCargadaEvnt($event)"
                  >
                  </app-persona-card>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="rows">
          <div class="d-block">
            <div class="col-12 footer">
              <app-footer-style-one></app-footer-style-one>
            </div>
          </div>
        </div>
      </ng-template>
    </div>
  </div>
</div>

<ng-template #templateNohayCategorias>
  <ng-container *ngIf="hayCategorias == false" ; else templateNohayCategorias>
    <ngx-spinner
      name="loadCategorias"
      [fullScreen]="true"
      type="ball-scale-multiple"
      size="medium"
    >
      <p class="loading">...</p>
    </ngx-spinner>
    <div class="col-1 pt-4">
      <i
        class="bi bi-arrow-return-left"
        style="font-size: 2em"
        (click)="volver()"
      ></i>
    </div>
    <div class="container text-center">
      <div class="row justify-content-center">
        <div class="col-lg-12 col-md-12 col-sm-12 pt-5 justify-content-center">
          <h1>{{ "casting.noCategorias" | translate }}</h1>
        </div>
      </div>
    </div>
  </ng-container>
</ng-template>

<ng-template #elseTemplate>
  <ng-container *ngIf="casting == null">
    <ngx-spinner
      name="loadCategorias"
      [fullScreen]="true"
      type="ball-scale-multiple"
      size="medium"
    >
      <p class="loading">...</p>
    </ngx-spinner>
    <div class="col-1 pt-4">
      <i
        class="bi bi-arrow-return-left"
        style="font-size: 2em"
        (click)="volver()"
      ></i>
    </div>
  </ng-container>
</ng-template>
<app-modal-confirmacion
  #modalComentarios
  (modalConfirm)="recibidoDelModal($event)"
></app-modal-confirmacion>
